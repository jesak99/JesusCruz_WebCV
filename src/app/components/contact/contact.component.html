<div class="bg-[var(--sand-light)] dark:bg-[var(--sand-dark)] py-16 px-6 transition-colors duration-300" appAnimateOnScroll>
  <div class="max-w-4xl mx-auto text-center mb-12">
    <h2 class="text-3xl font-bold text-[var(--terracotta-dark)] dark:text-[var(--terracotta-light)]" fadeTranslate="CONTACT.TITLE"></h2>
    <p class="mt-4 text-gray-700 dark:text-gray-300 max-w-xl mx-auto" fadeTranslate="CONTACT.DESCRIPTION"></p>
  </div>

  <form [formGroup]="formData" (ngSubmit)="enviarFormulario()"
    class="max-w-2xl mx-auto bg-white dark:bg-[var(--sand-light)] shadow-lg rounded-2xl p-8 border border-[var(--terracotta-light)] dark:border-[var(--terracotta-dark)] transition-colors duration-300">
    <!-- Nombre -->
    <div class="mb-6">
      <label for="name" class="block text-sm font-medium text-[var(--terracotta-dark)] dark:text-[var(--terracotta-light)] mb-2" fadeTranslate="CONTACT.NAME"></label>
      <input type="text" id="name" name="name" formControlName="nombre" placeholder="{{ 'CONTACT.NAME_DESCRIPTION' | translate }}"
        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-[var(--sand-light)] dark:bg-[var(--sand-dark)] text-gray-800 dark:text-gray-200 focus:outline-none focus:border-[var(--terracotta-dark)] dark:focus:border-[var(--terracotta-light)] transition"
      />
      <div *ngIf="formData.get('nombre')?.invalid && (formData.get('nombre')?.dirty || formData.get('nombre')?.touched)" class="mt-2 p-2 text-sm text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-700/20 rounded flex items-center gap-2">
        <svg class="w-4 h-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11V5a1 1 0 10-2 0v2a1 1 0 002 0zm-1 2a1 1 0 00-.993.883L9 10v4a1 1 0 001.993.117L11 14v-4a1 1 0 00-1-1z" clip-rule="evenodd" />
        </svg>
        <span *ngIf="formData.get('nombre')?.hasError('required')">
          {{ 'CONTACT.REQUIRED' | translate }}
        </span>
        <span *ngIf="formData.get('nombre')?.hasError('minlength')">
          {{ 'CONTACT.MINLENGTH' | translate:{number: formData.get('nombre')?.errors?.['minlength'].requiredLength} }}
        </span>
      </div>
    </div>
    <!-- Correo -->
    <div class="mb-6">
      <label for="email" class="block text-sm font-medium text-[var(--terracotta-dark)] dark:text-[var(--terracotta-light)] mb-2" fadeTranslate="CONTACT.EMAIL"></label>
      <input type="email" id="email" name="email" formControlName="email" placeholder="ejemplo@example.com"
        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-[var(--sand-light)] dark:bg-[var(--sand-dark)] text-gray-800 dark:text-gray-200 focus:outline-none focus:border-[var(--terracotta-dark)] dark:focus:border-[var(--terracotta-light)] transition"
      />
      <div *ngIf="formData.get('email')?.invalid && (formData.get('email')?.dirty || formData.get('email')?.touched)" class="mt-2 p-2 text-sm text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-700/20 rounded flex items-center gap-2">
        <svg class="w-4 h-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11V5a1 1 0 10-2 0v2a1 1 0 002 0zm-1 2a1 1 0 00-.993.883L9 10v4a1 1 0 001.993.117L11 14v-4a1 1 0 00-1-1z" clip-rule="evenodd" />
        </svg>
        <span *ngIf="formData.get('email')?.hasError('required')">
          {{ 'CONTACT.REQUIRED' | translate }}
        </span>
        <span *ngIf="formData.get('email')?.hasError('email')">
          {{ 'CONTACT.VALIDMAIL' | translate }}
        </span>
      </div>
    </div>

    <!-- Mensaje -->
    <div class="mb-6">
      <label for="message" class="block text-sm font-medium text-[var(--terracotta-dark)] dark:text-[var(--terracotta-light)] mb-2" fadeTranslate="CONTACT.MESSAGE"></label>
      <textarea id="message" name="message" formControlName="mensaje" rows="5" placeholder="{{ 'CONTACT.MESSAGE_DESCRIPTION' | translate }}"
        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-[var(--sand-light)] dark:bg-[var(--sand-dark)] text-gray-800 dark:text-gray-200 focus:outline-none focus:border-[var(--terracotta-dark)] dark:focus:border-[var(--terracotta-light)] transition"
      ></textarea>
      <div *ngIf="formData.get('mensaje')?.invalid && (formData.get('mensaje')?.dirty || formData.get('mensaje')?.touched)" class="mt-2 p-2 text-sm text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-700/20 rounded flex items-center gap-2">
        <svg class="w-4 h-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11V5a1 1 0 10-2 0v2a1 1 0 002 0zm-1 2a1 1 0 00-.993.883L9 10v4a1 1 0 001.993.117L11 14v-4a1 1 0 00-1-1z" clip-rule="evenodd" />
        </svg>
        <span *ngIf="formData.get('mensaje')?.hasError('required')">
          {{ 'CONTACT.REQUIRED' | translate }}
        </span>
        <span *ngIf="formData.get('mensaje')?.hasError('minlength')">
          {{ 'CONTACT.MINLENGTH' | translate:{number: formData.get('mensaje')?.errors?.['minlength'].requiredLength} }}
        </span>
        <span *ngIf="formData.get('mensaje')?.hasError('maxlength')">
          {{ 'CONTACT.MAXLENGTH' | translate:{number: formData.get('mensaje')?.errors?.['maxlength'].requiredLength} }}
        </span>
      </div>
    </div>

    <!-- Campo oculto -->
    <input type="text" name="website" formControlName="oculto" style="display: none" tabindex="-1" autocomplete="off"/>

    <!-- Botón -->
    <div class="text-center">
      <button type="submit" [disabled]="enviando || formData.invalid"
        class="bg-[var(--terracotta-dark)] dark:bg-[var(--terracotta-light)] text-white dark:text-[var(--sand-dark)] font-semibold px-8 py-3 rounded-lg shadow-md
              hover:shadow-lg hover:scale-105 transition-transform duration-200
              disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:hover:shadow-md">
        {{ enviando ? ('CONTACT.SENDING' | translate) : ('CONTACT.SEND' | translate) }}
      </button>

    </div>

    <!-- Toast -->
    <div [class.hidden]="!toast.mostrar" [@fadeSlide] id="toast"
      [ngClass]="toast.tipo === 'success'
        ? 'bg-white text-gray-500 dark:bg-gray-800 dark:text-gray-400'
        : 'bg-red-50 text-red-800 dark:bg-red-800 dark:text-red-200'"
      class="flex items-center w-full max-w-xs p-4 mt-4 rounded-lg shadow-sm fixed bottom-8 left-1/2 -translate-x-1/2 z-50"
      [class.opacity-0]="!toast.mostrar"
      [class.opacity-100]="toast.mostrar"
      role="alert">
      
      <div class="inline-flex items-center justify-center shrink-0 w-8 h-8 rounded-lg"
        [ngClass]="toast.tipo === 'success'
          ? 'bg-green-100 text-green-500 dark:bg-green-800 dark:text-green-200'
          : 'bg-red-100 text-red-500 dark:bg-red-900 dark:text-red-200'">

        <!-- Iconos -->
        <svg *ngIf="toast.tipo === 'success'" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
        </svg>
        <svg *ngIf="toast.tipo === 'error'" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM8.707 7.293a1 1 0 0 0-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 0 0 1.414 1.414L10 11.414l1.293 1.293a1 1 0 0 0 1.414-1.414L11.414 10l1.293-1.293a1 1 0 0 0-1.414-1.414L10 8.586 8.707 7.293Z" clip-rule="evenodd"/>
        </svg>
      </div>

      <!-- Mensaje -->
      <div class="ms-3 text-sm font-normal">{{ toast.mensaje }}</div>

      <!-- Botón -->
      <button type="button" (click)="cerrarToast()"
        class="ms-auto -mx-1.5 -my-1.5 rounded-lg focus:ring-2 p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 h-8 w-8"
        [ngClass]="toast.tipo === 'success'
          ? 'bg-white text-gray-400 hover:text-gray-900 dark:text-gray-500 dark:bg-gray-800 dark:hover:text-white'
          : 'bg-red-50 text-red-400 hover:text-red-900 dark:text-red-200 dark:bg-red-800 dark:hover:text-white'">
        <svg class="w-3 h-3" fill="none" viewBox="0 0 14 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
        </svg>
      </button>
    </div>
  </form>
</div>
